{% extends 'base.html' %}
{% block title %}{{ service.name }}{% endblock %}
{% block content %}

<!-- Custom CSS for modern, text-focused styling with image -->
<style>
/* Hero Section */
.hero {
    background: linear-gradient(135deg, #1a3c6e 0%, #2a5298 100%);
    min-height: 50vh;
    display: flex;
    align-items: center;
    text-align: center;
    color: white;
    position: relative;
    overflow: hidden;
}

.hero::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.4);
    z-index: 1;
}

.hero .container {
    position: relative;
    z-index: 2;
}

.hero h1 {
    font-size: 2.8rem;
    font-weight: 700;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.hero p {
    font-size: 1.2rem;
    max-width: 700px;
    margin: 0 auto 1.5rem;
}

/* Gallery Box */
.gallery-box {
    width: 100%;
    height: 400px;
    overflow: hidden;
    background-color: #f8f9fa;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 10px;
    transition: transform 0.3s ease;
}

.gallery-box img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    transition: transform 0.3s ease;
}

.gallery-box:hover img {
    transform: scale(1.05);
}

/* Card Styling */
.card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border: none;
    border-radius: 10px;
}

.card:hover {
    transform: translateY(-5px);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
}

/* Star Rating */
.star {
    color: #f8ce0b;
    font-size: 1.1rem;
    margin-right: 3px;
}

/* View More Button */
.view-more {
    margin-top: 1.5rem;
    text-align: center;
}

/* Section Headers */
h2 {
    font-weight: 600;
    color: #1a3c6e;
}

/* Gallery Styling */
.projects-gallery {
    display: flex;
    flex-direction: row;
    gap: 15px;
    flex-wrap: nowrap;
    justify-content: center;
}

.gallery-img {
    width: 250px;
    height: 200px;
    object-fit: cover;
    margin-bottom: 15px;
    border-radius: 5px;
    display: block;
    cursor: pointer;
    transition: transform 0.2s ease-in-out;
}

.gallery-img:hover {
    transform: scale(1.05);
}

/* Responsive Adjustments */
@media (max-width: 768px) {
    .hero {
        min-height: 40vh;
    }
    .hero h1 {
        font-size: 2rem;
    }
    .hero p {
        font-size: 1rem;
    }
    .gallery-box {
        height: 300px; /* Increased for better mobile display */
    }
    .projects-gallery {
        overflow-x: auto; /* Enable horizontal scrolling */
        white-space: nowrap; /* Keep images in a single row */
        justify-content: flex-start; /* Start from left for scrolling */
        padding: 10px 0; /* Add padding for better touch scrolling */
    }
    .gallery-img {
        width: 200px; /* Smaller width for mobile */
        height: 150px; /* Adjusted height for better proportions */
        object-fit: contain; /* Prevent distortion */
        image-rendering: -webkit-optimize-contrast; /* Improve clarity */
        image-rendering: crisp-edges;
        display: inline-block; /* Ensure inline layout for scrolling */
    }
}

@media (max-width: 576px) {
    .gallery-img {
        width: 180px; /* Further adjusted for smaller screens */
        height: 135px; /* Maintain proportions */
        object-fit: contain;
        border-radius: 8px; /* Slightly larger border radius */
    }
    .modal-body img {
        max-height: 80vh; /* Prevent modal image from touching edges */
        padding: 10px; /* Add padding for better presentation */
        object-fit: contain;
        image-rendering: -webkit-optimize-contrast;
        image-rendering: crisp-edges;
    }
}
@media (max-width: 576px) {
    .hero {
        padding-top: 100px; /* adjust this value to match your navbar height on phone */
    }
}

</style>

<!-- Hero Section -->
<div class="hero d-flex align-items-center text-center text-white">
    <div class="container">
        <h1>{{ service.name }}</h1>
        <p>{{ service.description }}</p>
        <a href="/contact" class="btn btn-primary btn-lg">Get a Free Quote</a>
        <a href="tel:++447477659370" class="btn btn-outline-light btn-lg mx-2">Call Now</a>
        {% set service_to_category = {
            'Kitchen Renovations': 'kitchen',
            'Bathroom Installations': 'bathroom',
            'Flooring Solutions': 'flooring',
            'Wardrobe Installations': 'wardrobe',
            'Plumbing Repairs': 'plumbing',
            'Carpentry & Tiling': 'carpentry_tiling',
            '3D Design Services': '3d_design'
        } %}
        {% set category = service_to_category.get(service.name, service.name.lower().replace(' ', '_')) %}
    </div>
</div>

<!-- Gallery Section -->
<div class="container my-5">
    <h1>{{ category.replace('_', ' ').title() }} Gallery</h1>
    {% if images %}
        <div class="projects-gallery">
            {% for image in images %}
                <img src="{{ url_for('static', filename='images/' + image.category + '/' + image.filename) }}"
                     alt="{{ category.replace('_', ' ').title() }}"
                     loading="lazy"
                     data-bs-toggle="modal"
                     data-bs-target="#imageModal"
                     data-img-src="{{ url_for('static', filename='images/' + image.category + '/' + image.filename) }}"
                     class="gallery-img">
            {% endfor %}
        </div>

        <!-- View More button -->
        <div class="view-more">
            <a href="{{ url_for('gallery_category', category=category) }}" class="btn btn-primary">
                View More
            </a>
        </div>
    {% else %}
        <p>No images available in this category.</p>
    {% endif %}
</div>

<!-- Modal for enlarged image view -->
<div class="modal fade" id="imageModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content bg-black border-0 position-relative">
            <button type="button" class="btn-close position-absolute top-0 end-0 m-3"
                    data-bs-dismiss="modal" aria-label="Close"
                    style="z-index:1050; filter: invert(25%) sepia(95%) saturate(7500%) hue-rotate(-5deg) brightness(95%) contrast(105%);"></button>
            <div class="modal-body p-0 text-center">
                <img id="modalImage" src="" style="max-width:100%; max-height:90vh; object-fit:contain;">
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const modalImage = document.getElementById("modalImage");
    document.querySelectorAll(".projects-gallery img").forEach(img => {
        img.addEventListener("click", function () {
            modalImage.src = img.dataset.imgSrc;
        });
    });
});
</script>

<div class="container my-5">
    <!-- Service Highlights -->
    <section class="mb-5">
        <h2 class="text-center mb-4">Why Choose Our {{ service.name }}?</h2>
        <div class="row text-center">
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm p-3">
                    <h3 class="h5">Premium Quality</h3>
                    <p class="small">Our team delivers exceptional craftsmanship with attention to every detail, ensuring lasting results.</p>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm p-3">
                    <h3 class="h5">Customized Approach</h3>
                    <p class="small">We tailor every project to your vision, creating spaces that reflect your style and needs.</p>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm p-3">
                    <h3 class="h5">Timely Completion</h3>
                    <p class="small">We prioritize efficiency, delivering projects on time without compromising quality.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Detailed Description -->
    <section class="mb-5">
        <h2 class="text-center mb-4">About {{ service.name }}</h2>
        {% set service_details = {
            'Kitchen Renovations': 'Transform your kitchen into a modern, functional hub. We specialize in bespoke cabinetry, sleek countertops, and efficient layouts that elevate your home’s heart, tailored to your lifestyle.',
            'Bathroom Installations': 'Create a spa-like retreat with our bathroom renovations. From precision tiling to modern fixtures, we design functional and stylish bathrooms that suit your space perfectly.',
            'Flooring Solutions': 'Enhance your home with durable, elegant flooring. Whether it’s hardwood, tile, or laminate, our installations combine aesthetics and practicality for lasting beauty.',
            'Wardrobe Installations': 'Optimize your space with custom wardrobes and storage solutions. Our designs are sleek, organized, and crafted to complement your home’s style.',
            'Plumbing Repairs': 'Ensure your home runs smoothly with our expert plumbing services. From leak repairs to fixture installations, we provide reliable solutions for comfort and efficiency.',
            'Carpentry & Tiling': 'Elevate your interiors with our precision carpentry and expert tiling. We create bespoke woodwork and flawless tile finishes that add elegance to any space.',
            '3D Design Services': 'Plan your project with confidence using our advanced 3D modeling. Visualize layouts, materials, and finishes before construction begins for a seamless outcome.'
        } %}
        <p class="lead text-center">
            {{ service_details.get(service.name, service.description + ' Our team is committed to delivering high-quality results tailored to your needs, with a focus on craftsmanship and customer satisfaction.') }}
        </p>
    </section>

    <!-- Testimonials Section -->
    {% if filtered_testimonials %}
        <section class="mb-5">
            <h2 class="text-center mb-4">Client Feedback</h2>
            <div class="row">
                {% for testimonial in filtered_testimonials %}
                    <div class="col-md-4 mb-4">
                        <div class="card shadow-sm p-3">
                            <p class="fst-italic">“{{ testimonial.content }}”</p>
                            <p>
                                {% if testimonial.rating %}
                                    {% for i in range(testimonial.rating) %}
                                        <span class="star">&#9733;</span>
                                    {% endfor %}
                                {% endif %}
                                <strong>{{ testimonial.client_name }}</strong>{% if testimonial.location %}, {{ testimonial.location }}{% endif %}
                            </p>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </section>
    {% endif %}

    <!-- Related Tips Section -->
    {% if filtered_tips %}
        <section class="mb-5">
            <h2 class="text-center mb-4">Tips for Your {{ service.name }} Project</h2>
            <div class="row">
                {% for tip in filtered_tips %}
                    <div class="col-md-6 mb-4">
                        <div class="card shadow-sm p-3">
                            <h3 class="h5">{{ tip.title }}</h3>
                            <p>{{ tip.content }}</p>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </section>
    {% endif %}

    <!-- Related Services Section -->
    {% set related_services = services | rejectattr('id', 'equalto', service.id) | list | sort(attribute='name') %}
    {% if related_services %}
        <section class="mb-5">
            <h2 class="text-center mb-4">Explore More Services</h2>
            <div class="row">
                {% for related_service in related_services | slice(3) %}
                    {% for s in related_service %}
                        <div class="col-md-4 mb-4">
                            <div class="card shadow-sm p-3">
                                <h3 class="h5">{{ s.name }}</h3>
                                <p class="small">{{ s.description | truncate(100, true) }}</p>
                                <a href="{{ url_for('service', service_id=s.id) }}" class="btn btn-outline-primary btn-sm">Learn More</a>
                            </div>
                        </div>
                    {% endfor %}
                {% endfor %}
            </div>
        </section>
    {% endif %}

    <!-- Call to Action -->
    <section class="text-center mb-5">
        <h2>Ready to Start Your {{ service.name }} Project?</h2>
        <p class="lead mb-4">Let our expert team bring your vision to life with precision and style.</p>
        <a href="/contact" class="btn btn-primary btn-lg"> Message Us</a>
        <a href="tel:+447477659370" class="btn btn-outline-primary btn-lg mx-2">Call 07477 659370</a>
    </section>
</div>

{% endblock %}